<html>
<head>
    <script src="libs/processing-1.4.1.js"></script>
    <script src="libs/jquery-2.0.3.js"></script>
    <script src="libs/underscore-1.5.2.js"></script>
    <script src="processing/engine.js"></script>
    <script src="processing/fireworks.js"></script>
</head>
<body style="margin:0; padding:0;">
    <canvas id="game_canvas" width="1440" height="900" style="cursor: crosshair; margin:0; padding:0;"></canvas>
    <script type="text/javascript">
        var canvas = document.getElementById("game_canvas");

        canvas.width = document.body.clientWidth;
        canvas.height = document.body.clientHeight;

        var inited = false;

        var game = fireworks();

        function sketchProc(processing) {
            processing.draw = function() {
                if (!inited) {
                    game.init(processing);
                    inited = true;
                }

                game.tick(processing);
            };
        }

        function processKeyChange(isKeyUp, eventData) {
            var ev = eventData || event;
            if (ev.keyCode == 87) {
                engine.keys.W = isKeyUp
            }
            if (ev.keyCode == 65) {
                engine.keys.A = isKeyUp
            }
            if (ev.keyCode == 83) {
                engine.keys.S = isKeyUp
            }
            if (ev.keyCode == 68) {
                engine.keys.D = isKeyUp
            }
        }

        $(document).bind("mousemove", function(event) {
            engine.mouseX = event.pageX;
            engine.mouseY = event.pageY;
        });

        $(document).bind("mousedown", function(event) {
            engine.clicked = true;
        });

        $(document).bind("mouseup", function(event) {
            engine.clicked = false;
        });

        $(document).bind("keyup", function(event) {
            processKeyChange(false, event);
        });

        $(document).bind("keydown", function(event) {
            processKeyChange(true, event);
        });

        $(document).ready(function () {
            var p = new Processing(canvas, sketchProc);
        });
    </script>
</body>
</html>
